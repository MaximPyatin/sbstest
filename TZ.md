SBS 2.5 - План реализации по этапам и назначение ролей
Этап	Название	Ключевые работы	Готовность (DoD)	Ответственный	Помощь	Зависимости
E0	Платформа и CI/CD	БД и миграции; Temporal; NATS/Redis; каркас FastAPI; Traefik; конвейер GitHub Actions (сборка, сканы, подпись); Helm/Terraform/Ansible; телеметрия OTel→Prometheus/Grafana.	Единый чарт Helm, автодеплой в тест, базовые дашборды работают.	Максим Пятин (тимлид/DevOps)	М. Мерцалов	—
E1	Многотенантность и IAM	Организации; RBAC; OIDC/SSO; локальные учётки; one-time токены для регистрации агентов; аудит-лог.	Вход через OIDC; жёсткое разграничение данных по организациям; экспорт аудита.	Максим Мерцалов (backend lead)	В. Руденко (БД), А. Нестеров	E0
E2	Хранилища и репозитории	S3/SFTP/локальный путь; мульти-репозитории; DR-репликация; WORM (Object Lock); ротация ключей restic.	Создание ≥2 репозиториев, параллельный backup в 2 цели, включаемый WORM.	Алексей Нестеров (restic/storage)	М. Мерцалов	E0, E1
E3	Задания и расписания	Модель Job; политики retention; Temporal Schedules; лимиты параллелизма/приоритеты; backup workflow с pre/post этапами; auto-forget/prune; флаги видимости для портала.	Из UI создаётся Job; по расписанию выполняется backup workflow; retention очищает старые снапшоты.	Алексей Нестеров	М. Мерцалов, В. Руденко (схемы)	E1, E2
E4	Агент Windows (ядро)	Служба Python; VSS-снимок; restic backup; лимиты CPU/IO/Net; офлайн-spool; автообновление; MSI; owner SID; обработка restore на агенте.	Бэкап/рестор с Windows-хоста стабильны, MSI-тихая установка.	Алексей Нестеров (agent core)	М. Мухин (VSS/COM), М. Пятин (MSI)	E3
E5	Процессы восстановления	Планирование restore + dry-run; политики конфликтов; restore-to-agent (стрим/резюм); пост-верификация хэшей.	Запуск restore-to-agent из UI, отчёт и верификация проходят.	Максим Мерцалов	А. Нестеров (логика на агенте)	E3, E4
E6	Портал восстановления (SSRP)	Индексация дерева файлов; API таймлайна/дерева/поиска/превью; DownloadTicket; download-proxy (HTTP Range); SPA (React) с SSO.	Пользователь видит свои снапшоты, ищет/просматривает/скачивает файлы.	Ирина «Caseus» Кукса (FE lead)	С. Довганчин (FE), М. Мерцалов (API), А. Нестеров (proxy)	E3, E5
E7	Проверки и аномалии	Периодический restic check; выборочная/полная верификация; правила аномалий; алерты.	Политики проверок активны; аномалии подсвечиваются.	Алексей Нестеров	М. Пятин (метрики), В. Руденко (SQL-отчёты)	E3
E8	Уведомления и интеграции	SMTP; Slack/Teams/Telegram; шаблоны; пользовательские настройки каналов.	Каналы настраиваются в UI; события доставляются.	Сергей Довганчин	И. Кукса (экран), М. Мерцалов (webhooks)	E7
E9	Admin UI (без лицензий)	Организации/пользователи; репозитории (WORM/DR); мастер Job/расписание; дашборд/календарь; аудит-лог; настройки уведомлений; список агентов. Экран «Лицензии» выносим в финал.	Все разделы, кроме «Лицензии», готовы.	Ирина «Caseus» Кукса	С. Довганчин, А. Никольский	E1–E3, E7–E8
E10	VSS Writers и хуки (post-GA)	Application-aware backup для Windows (Writers); профили приложений; pre/post hooks.	Профили SQL/AD/проч.; сценарии pre/post доступны.	Максим Мухин	А. Нестеров	E4
E11	macOS и Linux (самый конец)	Агент macOS: APFS snapshot, restic, PKG; Агент Linux: LVM/Btrfs/ZFS/fsfreeze, DEB/RPM.	Бэкап/рестор на macOS/Linux; установщики собраны.	Алексей Нестеров	М. Пятин (пакеты), М. Мерцалов	E4–E6
Распределение ролей
- Максим Пятин: Тимлид / PM / DevOps — ведёт E0, CI/CD, релизы, планирование.
- Максим Мерцалов: Техлид Backend — архитектура, БД/IAM/API, SSRP backend.
- Алексей Нестеров: Агенты/Workflows/Storage — restic/репозитории, Temporal-воркфлоу, Windows-агент, проверки.
- Ирина Кукса: Frontend Lead — Admin UI и SSRP SPA.
- Сергей Довганчин: Frontend Dev — уведомления, SSRP навигация/поиск, интеграции.
- Валерия Руденко: Backend/DB Engineer — схемы БД, отчётность/квоты/телеметрия, оптимизация SQL.
- Максим Мухин: Windows/VSS Specialist — VSS snapshot, VSS Writers, помощь с MSI/COM.
- Александр Никольский: Full‑stack Support (Junior) — поддержка UI, SSRP, мелкие бэкенд‑эндпоинты.
- Роман Шатеев: Product Owner — владелец требований, принимает ключевые решения и демо.
Соответствие разделов ТЗ этапам
• Раздел 1 (инфраструктура/CI/CD) → E0
• Раздел 2 (многотенантность/IAM) → E1
• Раздел 3 (репозитории/WORM/DR) → E2
• Раздел 4 (Jobs/retention/планировщик) → E3
• Раздел 5 (Windows‑агент) → E4
• Раздел 9 (Restore) → E5
• Раздел 10 (SSRP) → E6
• Раздел 11 (проверки/аномалии) → E7
• Раздел 12 (уведомления/интеграции) → E8
• Раздел 13 (Admin UI) → E9 (кроме экрана «Лицензии»)
• Раздел 8 (VSS Writers/хуки) → E10 (post‑GA)
• Разделы 6 и 7 (агенты macOS/Linux) → E11 (самый конец)


1. Текстовая структура задач
•	1. Инфраструктура платформы и CI/CD — подготовка базовой облачной инфраструктуры: БД (PostgreSQL 18) с миграциями, оркестратор задач Temporal, шина событий NATS, кеш/координация Redis; базовый каркас микросервисов (FastAPI) и ingress (Traefik). Также настройка конвейера CI/CD (GitHub Actions) для сборки/сканирования и развёртывания (контейнеры с подписью, Helm-чарт, Terraform/Ansible), мониторинг (OpenTelemetry → Prometheus/Grafana) и базовых политик безопасности (TLS, образа).
Сложность: Medium; Зависимости: нет;
•	1.1 Настройка базы данных и миграций схемы (PostgreSQL + Alembic).
Сложность: Medium; Зависимости: нет;
•	1.2 Развёртывание оркестратора Temporal для workflow (установка сервиса, интеграция).
Сложность: Medium; Зависимости: нет;
•	1.3 Интеграция шины событий NATS и кеша Redis (деплой сервисов, подключение из кода).
Сложность: Low; Зависимости: нет;
•	1.4 Реализация каркаса Core API сервиса (FastAPI) и базовой структуры микросервисов CP.
Сложность: Medium; Зависимости: нет;
•	1.5 Настройка конвейера CI/CD (сборка, тесты, SBOM/сканы, push образов, деплой) и подписи контейнеров.
Сложность: Medium; Зависимости: нет;
•	1.6 Скрипты и шаблоны развертывания (Helm chart, Terraform, Ansible, Docker Compose) для разных сред.
Сложность: Medium; Зависимости: нет;
•	1.7 Мониторинг и телеметрия (добавление OpenTelemetry, дашборды Grafana, алертинг).
Сложность: Low; Зависимости: нет;
•	2. Многотенантность и управление доступом (IAM) — реализация изоляции организаций и ролевой модели доступа (OrgAdmin, Operator, Auditor, EndUser). Включает поддержку единого входа OIDC/SSO (Keycloak/Okta/AD) и опционально локальных аккаунтов, а также механизм одноразового токена регистрации агента. Необходимо вести неизменяемый аудит действий (лог действий с экспортом) для комплаенса.
Сложность: Medium; Зависимости: 1;
•	2.1 Модель организаций и изоляция данных (привязка пользователей, агентов, репозиториев к Organization).
Сложность: Medium; Зависимости: 1;
•	2.2 Роли пользователей и RBAC (OrgAdmin, Operator, Auditor, EndUser) – назначение ролей и проверка прав на операции в рамках организации.
Сложность: Medium; Зависимости: 2.1;
•	2.3 Интеграция OIDC (SSO) для аутентификации – настройка OAuth2/OIDC провайдера, маппинг групп на роли; поддержка 2FA на стороне провайдера.
Сложность: Medium; Зависимости: 1;
•	2.4 Поддержка локальных учётных записей (альтернативный вход без OIDC, по email/паролю) – опционально для изолированных внедрений.
Сложность: Low; Зависимости: 1;
•	2.5 Механизм регистрации агентов по токену – выпуск одноразовых токенов привязки агента к организации, обмен на долгоживущий сертификат.
Сложность: Medium; Зависимости: 2.1;
•	2.6 Аудит-лог действий и экспорт – ведение append-only журнала всех ключевых действий (создание задач, логины и пр.) с возможностью экспорта CSV/JSON.
Сложность: Medium; Зависимости: 1;
•	3. Репозитории и хранение данных — поддержка резервного копирования в различные хранилища. Реализуется интеграция с S3-совместимым объектным хранилищем и SFTP-серверами в качестве бекенда для restic. Предусмотрена работа с локальными путями (в т.ч. SMB/NFS как локально примонтированные, с предупреждениями). Также обеспечивается мульти-репозиторий: запись сразу в два и более хранилища и/или фоновая репликация данных для DR. Вводится неизменяемость (WORM): поддержка S3 Object Lock для защиты снапшотов от удаления в течение заданного периода.
Сложность: High; Зависимости: 1, 2;
•	3.1 Поддержка хранения в S3 (AWS, MinIO и аналогичные) через restic – настройка доступа, шифрование и пр.
Сложность: Medium; Зависимости: 1;
•	3.2 Поддержка хранения по SFTP (репозиторий на удалённом сервере) – настройка ключей/паролей и путей.
Сложность: Medium; Зависимости: 1;
•	3.3 Поддержка локального пути (директория на диске сервера CP, либо SMB/NFS-монтирование) с проверками стабильности канала и блокировок.
Сложность: Low; Зависимости: 1;
•	3.4 Синхронная запись в несколько репозиториев (multi-repo) для задач бэкапа – настройка задания на одновременный backup в два хранилища.
Сложность: High; Зависимости: 3.1, 3.2;
•	3.5 Фоновая репликация репозитория (DR copy) – сервис копирования новых снапшотов из основного хранилища в дополнительное по расписанию.
Сложность: High; Зависимости: 3.1;
•	3.6 Иммутабельность (WORM) для S3 – установка Object Lock на загруженные объекты, запрет удаления снапшотов до истечения политики.
Сложность: High; Зависимости: 3.1;
•	3.7 Ротация ключей шифрования репозитория – поддержка restic key rotate для смены пароля репо, процедура escrow ключей.
Сложность: Medium; Зависимости: 3.1;
•	4. Задания и планирование бэкапов — реализация управления заданиями резервного копирования (Jobs) и их расписанием. Включает создание задания с указанием источников (папки, шаблоны, профили), исключений и расписания (удобный UI редактор графика, окна, исключения). Предусмотрены политики хранения (retention): различная глубина хранения (последние N, ежедневные/еженедельные и т.д.) и отметка важных точек, а также настройки immutability на уровне репо/префикса. Система должна поддерживать ограничение параллелизма (global/per-org/per-repo) и приоритеты задач (restore выше backup, и т.д.), с очередью ожидающих задач. Оркестрация выполнения – через Temporal workflows: последовательность snapshot → pre-hook → запуск restic backup → post-hook, фиксация метаданных, отправка событий прогресса и результат. Также реализуется удаление старых точек восстановления по retention-политике (авто-forget старых snapshot’ов) и отметка видимости наборов данных для портала (owner-only или shared).
Сложность: High; Зависимости: 2, 3;
•	4.1 Модель задания бэкапа: сущность Job с источниками данных (папки, файлы, профили), масками включения/исключения, и привязкой к целевому репозиторию(ям).
Сложность: Medium; Зависимости: 2, 3;
•	4.2 Конфигурация политик хранения (retention): параметры хранения для задания (правила keep-last, daily/weekly/monthly, пометка критичных снапшотов).
Сложность: Medium; Зависимости: 4.1;
•	4.3 Реализация планировщика задач: преобразование расписания из UI (окна времени, дни, blackout) в cron/Temporal Schedule и запуск задач по графику.
Сложность: Medium; Зависимости: 4.1;
•	4.4 Ограничение параллельности и приоритеты: глобальные и по организациям/репозиториям лимиты одновременных backup-задач (например, 50 глобально) с реализацией очереди ожидающих задач и Fairness-алгоритма.
Сложность: Medium; Зависимости: 4.3;
•	4.5 Оркестрация выполнения бэкапа: разработка workflow (Temporal) для задачи backup – управление шагами снапшота, выполнением pre/post hook, запуском restic backup и обработкой ошибок. Интеграция с агентом: отправка команды на агент, получение статусов через Event Bus.
Сложность: High; Зависимости: 4.1, 5;
•	4.6 Удаление старых снапшотов по retention: автоматическое выполнение restic forget/prune согласно политике хранения после успешного бэкапа.
Сложность: Medium; Зависимости: 4.1, 3;
•	4.7 Настройка видимости бэкапов в портале: атрибуты portal_scope и теги portal:visible/hidden для каждого задания, чтобы пометить наборы как личные либо общие/скрытые.
Сложность: Low; Зависимости: 4.1;
•	5. Агент резервного копирования для Windows — разработка агента под Windows (Python 3.14). Реализует создание снапшота тома через VSS перед копированием данных, инкрементальный бэкап файлов на restic-репозиторий, сжатие и шифрование (встроено в restic). Агент обеспечивает контроль нагрузки (ограничение CPU/IO/Network), надёжность при обрывах (бэкап в локальный буфер с догрузкой при восстановлении сети) и прокси-режим. Также реализуется авто-обновление агента и подписанный установщик MSI для развёртывания (тихий режим с токеном подключения). Каждый backup привязывается к владельцу (SID пользователя) для маппинга данных в портал восстановления.
Сложность: High; Зависимости: 1, 2, 4;
•	5.1 Базовая архитектура Windows-агента: служба на Python (asyncio) с подключением к CP (по API/EventBus), получение команд и отправка статусов.
Сложность: Medium; Зависимости: 1, 2;
•	5.2 Создание снапшота томов через VSS (Volume Shadow Copy) – использование Windows API для создания snapshot’а диска перед чтением данных.
Сложность: High; Зависимости: 5.1;
•	5.3 Интеграция с restic для бэкапа – запуск команды restic backup на агенте (используя снапшот как источник), передача включений/исключений, обработка прогресса/логов.
Сложность: Medium; Зависимости: 5.1;
•	5.4 Ограничение ресурсов на агенте – применение лимитов CPU, дисковой и сетевой I/O для процесса бэкапа (Windows Job Objects или аналоги).
Сложность: Medium; Зависимости: 5.1;
•	5.5 Локальный офлайн-буфер (spool) – сохранение данных бэкапа в локальное хранилище при потере сети и последующая автоматическая догрузка в репозиторий при восстановлении соединения.
Сложность: High; Зависимости: 5.3;
•	5.6 Механизм авто-обновления агента – проверка наличия новой версии, скачивание и запуск обновления (с верификацией подписи пакета).
Сложность: Medium; Зависимости: 5.1;
•	5.7 Установщик Windows (MSI) с подпиcкой – сборка инсталлятора (MSI) для агентa, поддержка тихой установки с заранее заданными параметрами server_url, org_id, token.
Сложность: Medium; Зависимости: 5.1;
•	5.8 Идентификация владельца данных – получение SID/имени текущего пользователя системы и сохранение в snapshot metadata для привязки бэкапов к владельцу (EndUser).
Сложность: Low; Зависимости: 5.3;
•	5.9 Обработка команд восстановления на агенте – при получении задачи restore агент принимает поток данных или выполняет restic restore выбранных файлов, применяет политики перезаписи и записывает файлы на диск.
Сложность: Medium; Зависимости: 5.1, 4;
•	6. Агент резервного копирования для macOS — разработка кроссплатформенного агента для macOS 12+ с учётом особенностей системы (TCC). Поддерживает создание snapshot файловой системы APFS для консистентного бэкапа, интеграцию с restic (как и Windows-версия), выпуск пакета установки PKG.
Сложность: High; Зависимости: 1, 2, 4, 5; Статус: После релиза**
•	6.1 Адаптация ядра агента под macOS (совместимость Python, привилегии, работа сервисом).
Сложность: Medium; Зависимости: 5.1; Статус: После релиза**
•	6.2 Реализация snapshot на macOS (APFS) – использование API APFS для создания моментального снимка диска с учётом правил TCC (доступ к файлам пользователя).
Сложность: High; Зависимости: 6.1; Статус: После релиза**
•	6.3 Интеграция restic на macOS – запуск restic-бэкапа с использованием APFS-снимка.
Сложность: Medium; Зависимости: 6.1; Статус: После релиза**
•	6.4 Пакет установки для macOS (PKG, подписанный) – сборка инсталлятора агента для macOS, тестирование тихой установки.
Сложность: Medium; Зависимости: 6.1; Статус: После релиза**
•	7. Агент резервного копирования для Linux — разработка версии агента для популярных дистрибутивов Linux (Ubuntu/Debian, RHEL/Alma, SUSE). Поддерживает создание snapshot/Freeze на уровне LVM/Btrfs/ZFS (где применимо), либо fs-freeze для ext4. Интеграция с restic аналогична, сборка пакетов .deb и .rpm.
Сложность: High; Зависимости: 1, 2, 4, 5; Статус: После релиза**
•	7.1 Адаптация агента под Linux (демон Systemd, взаимодействие с ОС).
Сложность: Medium; Зависимости: 5.1; Статус: После релиза**
•	7.2 Поддержка snapshot Linux – интеграция с LVM/Btrfs/ZFS для создания снапшотов либо использование fsfreeze для остальных ФС.
Сложность: High; Зависимости: 7.1; Статус: После релиза**
•	7.3 Интеграция restic на Linux – запуск резервного копирования с применением сделанного снапшота.
Сложность: Medium; Зависимости: 7.1; Статус: После релиза**
•	7.4 Пакеты установки DEB/RPM – подготовка и тестирование установочных пакетов для Debian/Ubuntu (DEB) и RHEL/Alma/SUSE (RPM), подписывание.
Сложность: Medium; Зависимости: 7.1; Статус: После релиза**
•	8. Поддержка VSS Writers и хуков (Application-Aware) — реализация application-aware бэкапа для консистентного сохранения приложений. В Windows – оркестрация VSS Writers (SQL Server, Exchange, AD и др.) для корректного сброса состояния перед снятием snapshot. Для универсальности – поддержка выполнения кастомных pre/post скриптов перед и после бэкапа (настраиваемые, с таймаутами). Предусмотрена библиотека профилей для типовых приложений (наборы Writers, сервисов, скриптов) и обработка ошибок Writers (таймауты, rollback при сбоях).
Сложность: High; Зависимости: 5; Статус: После релиза**
•	8.1 Поддержка VSS Writers в агенте Windows – использование COM VSS API для координации Writers (базы данных, каталог служб) во время snapshot, обработка ошибок и таймаутов.
Сложность: High; Зависимости: 5.2; Статус: После релиза**
•	8.2 Профили приложений и шаблоны – создание профилей для распространённых приложений (SQL, Exchange и т.д.) с указанием требуемых Writers или команд, для упрощения настройки job.
Сложность: Medium; Зависимости: 8.1; Статус: После релиза**
•	8.3 Выполнение pre/post hook-скриптов – поддержка запуска заданных команд до и после бэкапа (с заданием таймаутов и допустимых кодов возврата).
Сложность: Medium; Зависимости: 5.1; Статус: После релиза**
•	9. Процессы восстановления (Restore) — реализация восстановления данных из резервных копий. Включает два основных сценария: загрузка отдельных файлов через временные ссылки и полноценное восстановление на исходный либо новый хост (Restore-to-Agent). Реализуется планирование восстановления с опцией Dry-run (предварительная оценка объёма и выявление конфликтов), выбор политик при коллизиях (перезаписать, пропустить, переименовать) и сам процесс восстановления: передача данных на агент с возможностью докачки при обрыве соединения. После завершения выполняется проверка целостности (хеш-верификация выборочная или полная) и формируется отчёт.
Сложность: Medium; Зависимости: 4, 5;
•	9.1 Планирование восстановления и Dry-run – выбор точки восстановления/файлов, расчет требуемого объёма и времени, предварительное выявление конфликтующих файлов на целевом хосте.
Сложность: Medium; Зависимости: 4;
•	9.2 Настройка политик конфликта – опции для существующих файлов: перезаписать, пропустить, сохранить обе версии (с суффиксом).
Сложность: Medium; Зависимости: 9.1;
•	9.3 Выполнение Restore-to-Agent – запуск workflow восстановления: потоковая передача данных на агент (с разбивкой на блоки, ретраями) или инициирование restic restore на агенте. Обеспечивается прогресс, возможность паузы/возобновления и отложенный старт до появления офлайн-агента.
Сложность: High; Зависимости: 9.2, 5.9;
•	9.4 Верификация после восстановления – выборочная или полная проверка хеш-сумм восстановленных файлов, сравнение с оригиналами; отчёт об итогах и ошибки, повторные попытки при сбоях.
Сложность: Medium; Зависимости: 9.3;
•	10. Портал восстановления (SSRP) — разработка Self-Service Restore Portal для конечных пользователей. Позволяет безопасно через веб-интерфейс просматривать свои резервные копии, искать файлы, предпросматривать содержимое и осуществлять восстановление файлов самостоятельно. Состоит из отдельного фронтенда (React SPA) и backend-API, интегрированного с CP. Реализуется служба индексации (Tree/Index) для ускоренного построения дерева файлов и поиска по именам среди backup-снапшотов. В портале поддерживается авторизация через OIDC (роль EndUser), используются scoped-токены и одноразовые ссылки для скачивания файлов (DownloadTicket) с ограничением времени, IP и количества использований. Предусмотрены ограничения на объём скачивания, число одновременных загрузок и глубину истории доступных снапшотов.
Сложность: High; Зависимости: 2, 4, 9;
•	10.1 Сервис индексации дерева файлов (Tree/Index Service) – сбор метаданных файлов из новых снапшотов (после backup) и хранение для быстрого поиска/навигации.
Сложность: High; Зависимости: 4;
•	10.2 SSRP API: выдача списка доступных снапшотов и таймлайна – endpoint, возвращающий перечень точек восстановления (по устройствам/дате) с фильтрацией.
Сложность: Medium; Зависимости: 10.1;
•	10.3 SSRP API: проводник файлового дерева – endpoint для запроса списка файлов/папок выбранного снапшота (с поддержкой фильтров типа «только изменённые»).
Сложность: Medium; Зависимости: 10.1;
•	10.4 SSRP API: поиск файлов по имени/пути/расширению – endpoint полнотекстового поиска по индексированным метаданным файлов.
Сложность: Medium; Зависимости: 10.1;
•	10.5 SSRP API: предпросмотр файлов – возможность получить содержимое/превью файла определённых типов (текст, изображения, PDF) для отображения в портале.
Сложность: Medium; Зависимости: 10.1, 10.7;
•	10.6 Сервис портальных токенов (DownloadTicket) – генерация одноразовых токенов для скачивания файлов, ограниченных по TTL (напр., 15 мин) и привязанных к пользователю/IP.
Сложность: Medium; Зависимости: 10.1;
•	10.7 Download Proxy для выдачи файлов – сервис проксирования скачивания: получает запрос с токеном, валидирует ограничения (IP/TTL) и отдаёт файл (с поддержкой HTTP Range для докачки).
Сложность: High; Зависимости: 10.6, 3;
•	10.8 Веб-приложение SSRP (React) – разработка интерфейса портала: вход через SSO, отображение списка устройств и снапшотов (таймлайн), навигация по файловому дереву, поиск, просмотр файлов и инициирование загрузки или restore с прогрессом. Реализация мер безопасности (CSP, CSRF, rate limiting) и аудита действий портала.
Сложность: High; Зависимости: 10.2–10.7;
•	11. Верификация данных и обнаружение аномалий — механизм проверки целостности резервных копий и выявления нетипичного поведения. Регулярно выполняется restic check для каждого репозитория и выборочная проверка (N% файлов) после резервного копирования. По расписанию могут выполняться полные проверки всех данных. Также реализуется обнаружение аномалий в результатах бэкапов: правила выявляют необычно малый объём изменений, аномально короткую/долгую длительность, отсутствие измененных файлов в рабочее время, всплеск удалений и т.д.. При срабатывании аномалий генерируются оповещения и пометки в интерфейсе (например, выделение на календаре).
Сложность: Medium; Зависимости: 4, 3;
•	11.1 Периодическая проверка репозиториев (restic check) – запуск проверки индексов и хранилища по расписанию (настроенному админом или дефолтному).
Сложность: Medium; Зависимости: 4;
•	11.2 Выборочная верификация файлов – после каждого бэкапа проверять целостность случайной выборки (например, 5%) файлов из нового snapshot (сравнить хеши путем выгрузки или restic check --read-data-subset).
Сложность: Medium; Зависимости: нет;
•	11.3 Полная проверка данных – периодическое полное сканирование и верификация всех данных репозитория (например, раз в месяц), по настроенной политике.
Сложность: Low; Зависимости: нет;
•	11.4 Обнаружение аномалий в бэкапах – анализ метрик выполненных задач: сравнение объёма и длительности с недавними значениями, проверка числа измененных файлов и удалений.
Сложность: Medium; Зависимости: 4;
•	11.5 Реакция на аномалии – генерация оповещений (событие/уведомление) при выявлении аномального кейса и визуальная индикация в UI (отметка на календаре или в списке задач).
Сложность: Medium; Зависимости: 11.4, 12;
•	12. Уведомления и интеграции — подсистема оповещения администраторов и интеграции со внешними сервисами. Поддерживаются каналы: email (SMTP), мессенджеры Slack/Teams/Telegram через вебхуки, а также произвольные Webhook для SIEM и др.. Необходимо отправлять уведомления о ключевых событиях: старт/завершение задач, ошибки, срабатывание аномалий, достижение квот или истечение лицензии. Реализуются шаблоны сообщений для разных типов событий (можно кастомизировать). Предусмотрена настройка каналов в UI (ввод SMTP-сервера, webhook URL и пр.).
Сложность: Medium; Зависимости: 4, 11;
•	12.1 Email-уведомления (SMTP) – отправка писем на заданные адреса о событиях (ошибки задач, отчёты бэкапа, предупреждения). Настройка SMTP-сервера (TLS, аутентификация).
Сложность: Medium; Зависимости: нет;
•	12.2 Интеграция со Slack/Teams/Telegram – отправка сообщений о событиях через вебхуки (форматирование текста, поддержка нескольких получателей/каналов).
Сложность: Medium; Зависимости: нет;
•	12.3 Шаблоны уведомлений – разработка шаблонов содержимого для каждого типа события (успех, ошибка, аномалия, мало места, лицензия и т.д.).
Сложность: Low; Зависимости: нет;
•	12.4 Управление настройками оповещений – модель и API для хранения предпочтений: какие события и куда отправлять, параметры (список email, URL вебхуков).
Сложность: Medium; Зависимости: 2;
•	13. Административный веб-интерфейс (Admin UI) — разработка веб-консоли администратора (React/TypeScript) для управления системой. Интерфейс многотенантный: администратор организации может управлять своими сущностями. Предусмотрены разделы: управление организациями и пользователями (создание организаций, приглашение пользователей, назначение ролей), управление репозиториями (добавление/редактирование, настройка WORM и DR-репликации), управление заданиями бэкапа (создание/редактирование задач, расписания с визуальным редактором, просмотр включенных/исключенных данных), мониторинг выполнения задач (дашборд статусов, календарь бэкапов с отмеченными аномалиями), просмотр журналов и аудит-логов, управление лицензиями (ввод лицензионного ключа, просмотр активных агентов и использования) и настройка уведомлений (SMTP, вебхуки).
Сложность: Medium; Зависимости: 2, 3, 4, 11, 12, 14;
•	13.1 UI для организаций и пользователей – экран создания/редактирования организаций; управление пользователями, назначение ролей (OrgAdmin/Operator/Auditor).
Сложность: Medium; Зависимости: 2;
•	13.2 UI для репозиториев – формы добавления нового хранилища (S3, SFTP, локальный), настройки WORM и отображение статуса репликации. Предупреждение при выборе SMB/NFS как хранилища.
Сложность: Medium; Зависимости: 3;
•	13.3 UI для заданий бэкапа – мастер создания/редактирования Job: выбор устройства/агента, источников, правил исключений, настройка расписания (интерактивный редактор графика) и политики хранения. Отметка видимости для портала (флажок «доступно конечному пользователю»).
Сложность: High; Зависимости: 4;
•	13.4 Дашборд и календарь задач – экран со статусами последних задач, график/календарь запусков бэкапов по дням (отображение успешных, неудач, аномалий) для каждой задачи или агента.
Сложность: Medium; Зависимости: 4, 11;
•	13.5 Интерфейс аудита – просмотр и фильтрация записей аудит-лога; возможность экспорта журнала действий в CSV/JSON.
Сложность: Low; Зависимости: 2.6;
•	13.6 UI управления лицензиями – отображение информации о лицензии (валидность, лимиты агентов/функционала), ввод нового лицензионного ключа или загрузка офлайн-файла активации.
Сложность: Medium; Зависимости: 14;
•	13.7 UI настроек уведомлений – форма для настройки SMTP-сервера (адрес, порт, учётка) и вебхуков Slack/Teams (URL, секрет), выбор событий для оповещения.
Сложность: Medium; Зависимости: 12;
2. Таблица задач
№	Название	Сложность	Зависимости	Статус
1.	Инфраструктура платформы и CI/CD	Medium	–	Релиз
1.1	База данных и миграции	Medium	–	Релиз
1.2	Интеграция Temporal	Medium	–	Релиз
1.3	Шина событий (NATS) и кеш (Redis)	Low	–	Релиз
1.4	Шаблон сервисов CP (Core API)	Medium	–	Релиз
1.5	Конвейер CI/CD	Medium	–	Релиз
1.6	Скрипты деплоя (Helm/Terraform)	Medium	–	Релиз
1.7	Мониторинг и телеметрия	Low	–	Релиз
2.	Многотенантность и RBAC	Medium	1	Релиз
2.1	Модель организаций и изоляция	Medium	1	Релиз
2.2	Роли пользователей (RBAC)	Medium	2.1	Релиз
2.3	Интеграция OIDC SSO	Medium	1, 2.1	Релиз
2.4	Локальные аккаунты	Low	1	Релиз
2.5	Регистрация агентов (one-time token)	Medium	2.1	Релиз
2.6	Аудит действий (журнал/экспорт)	Medium	1	Релиз
3.	Репозитории, мульти-репо и WORM	High	1, 2	Релиз
3.1	Поддержка S3 хранилища	Medium	1	Релиз
3.2	Поддержка SFTP хранилища	Medium	1	Релиз
3.3	Поддержка локального пути (SMB/NFS)	Low	1	Релиз
3.4	Синхронный backup в 2 репозитория	High	3.1, 3.2	Релиз
3.5	Репликация репозиториев (DR)	High	3.1	Релиз
3.6	Неизменяемость (WORM)	High	3.1	Релиз
3.7	Ротация ключей шифрования restic	Medium	3.1	Релиз
4.	Задания и планирование бэкапов	High	2, 3	Релиз
4.1	Модель задания (источники, фильтры)	Medium	2, 3	Релиз
4.2	Политики хранения (retention)	Medium	4.1	Релиз
4.3	Планировщик (cron/Temporal)	Medium	4.1	Релиз
4.4	Лимиты параллельности и приоритеты	Medium	4.3	Релиз
4.5	Workflow бэкапа (оркестрация)	High	4.1, 5	Релиз
4.6	Удаление старых снапшотов (ретеншн)	Medium	4.1, 3	Релиз
4.7	Видимость наборов в портале (флаги)	Low	4.1	Релиз
5.	Агент для Windows	High	1, 2, 4	Релиз
5.1	Архитектура агента (Python)	Medium	1, 2	Релиз
5.2	Снимки томов (VSS) на Windows	High	5.1	Релиз
5.3	Интеграция с restic (backup)	Medium	5.1	Релиз
5.4	Ограничение CPU/IO/Net	Medium	5.1	Релиз
5.5	Локальный офлайн-буфер (spool)	High	5.3	Релиз
5.6	Авто-обновление агента	Medium	5.1	Релиз
5.7	Установщик Windows (MSI)	Medium	5.1	Релиз
5.8	Идентификация владельца (SID)	Low	5.3	Релиз
5.9	Обработка restore на агенте	Medium	5.1, 4	Релиз
6.	Агент для macOS	High	1, 2, 4, 5	После релиза
6.1	Портирование агента на macOS	Medium	5.1	После релиза
6.2	Снимки APFS (macOS)	High	6.1	После релиза
6.3	Интеграция с restic (macOS)	Medium	6.1	После релиза
6.4	Установщик macOS (PKG)	Medium	6.1	После релиза
7.	Агент для Linux	High	1, 2, 4, 5	После релиза
7.1	Портирование агента на Linux	Medium	5.1	После релиза
7.2	Снимки LVM/Btrfs/ZFS (Linux)	High	7.1	После релиза
7.3	Интеграция с restic (Linux)	Medium	7.1	После релиза
7.4	Установщики DEB/RPM (Linux)	Medium	7.1	После релиза
8.	Поддержка VSS Writers и хуков	High	5	После релиза
8.1	VSS Writers для Windows (SQL/AD/etc)	High	5.2	После релиза
8.2	Профили приложений и скрипты	Medium	8.1	После релиза
8.3	Pre/post hooks выполнение	Medium	5.1	После релиза
9.	Восстановление (Restore)	Medium	4, 5	Релиз
9.1	Планирование restore (dry-run)	Medium	4	Релиз
9.2	Политики конфликтов при восстановлении	Medium	9.1	Релиз
9.3	Выполнение restore-to-agent (стрим/резюм)	High	9.2, 5.9	Релиз
9.4	Проверка целостности после restore	Medium	9.3	Релиз
10.	Портал восстановления (SSRP)	High	2, 4, 9	Релиз
10.1	Сервис индексации файлов (Tree/Index)	High	4	Релиз
10.2	API SSRP: список снимков/таймлайн	Medium	10.1	Релиз
10.3	API SSRP: дерево файлов и фильтры	Medium	10.1	Релиз
10.4	API SSRP: поиск по названию	Medium	10.1	Релиз
10.5	Превью файлов (текст/изобр./PDF)	Medium	10.1, 10.7	Релиз
10.6	Portal Token Service (DownloadTicket)	Medium	10.1	Релиз
10.7	Download Proxy (range/возобновление)	High	10.6, 3	Релиз
10.8	SSRP Web App (React)	High	10.2–10.7	Релиз
11.	Проверки и аномалии	Medium	4, 3	Релиз
11.1	Периодический restic check	Medium	4	Релиз
11.2	Выборочная проверка файлов (N%)	Medium	–	Релиз
11.3	Полный verify по расписанию	Low	–	Релиз
11.4	Выявление аномалий бэкапа	Medium	4	Релиз
11.5	Оповещения и отметки о аномалиях	Medium	11.4, 12	Релиз
12.	Уведомления и интеграции	Medium	4, 11	Релиз
12.1	Email-уведомления (SMTP)	Medium	–	Релиз
12.2	Интеграция Slack/Teams/Telegram	Medium	–	Релиз
12.3	Шаблоны сообщений для событий	Low	–	Релиз
12.4	Настройка каналов уведомлений	Medium	2	Релиз
13.	Административный веб-интерфейс (Admin UI)	Medium	2, 3, 4, 11, 12, 14	Релиз
13.1	UI организаций/пользователей	Medium	2	Релиз
13.2	UI репозиториев (WORM/DR)	Medium	3	Релиз
13.3	UI заданий бэкапа (расписание)	High	4	Релиз
13.4	Мониторинг задач (дашборд, календарь)	Medium	4, 11	Релиз
13.5	Просмотр аудит-лога	Low	2.6	Релиз
13.6	UI лицензий и активации	Medium	14	Релиз
13.7	UI настроек уведомлений	Medium	12	Релиз
13.8	UI агентов и версий	Medium	5	Релиз

